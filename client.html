<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <!-- CSS only -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet"href="index.css">
  <title>Document</title>
  <script src="https://unpkg.com/feather-icons"></script>
  <script src="	https://unpkg.com/axios@0.24.0/dist/axios.min.js"></script>
</head>

<body>



  <div class="row vertical-center">
    <form  id="form"class="col-md-4">
      <h1> File Merger <i data-feather="upload-cloud"></i></h1>
      <br/>
      <p>
        <label class="sr-only" for=""> File 1</label>
        <input class="form-control" type="file" id="fileInput"  autofocus multiple>
      </p>
      <p>
        <label class="sr-only" for=""> File 2</label>
        <input class="form-control" type="file"id="fileInput2"  autofocus multiple>
      </p>
      <button class="btn btn-primary btn-block" id="uploadButton" type="sumbit">Upload</button>
      <div id="loader"></div>
      <br />
      <div id="message"></div>
      <div id="urlLink"></div>
  
    </form>
  
    </div>



</div>


  <script>
     let loader = document.getElementById("loader");
     let message = document.getElementById("message");
     let form = document.getElementById("form");
     let button = document.getElementById("uploadButton");
     let urlLink = document.getElementById("urlLink")

     form.addEventListener("submit", function(e){
      e.preventDefault();

      let fileElement = document.getElementById('fileInput')
      let fileElement2 = document.getElementById('fileInput2')

      // check if user had selected a file
      if (fileElement.files.length === 0) {
        alert('please choose some files')
        return
      }
      else if(fileElement2.files.length === 0){
        alert('please choose some files')
        return
      }
      
     


      let files = Array.from(fileElement.files)

      let formData = new FormData();
      files.forEach(file => {
        formData.append('file', file);
      })
      
      axios.post("http://localhost:3002/uploadFiles", formData, {
        onUploadProgress: progressEvent => {
          const percentCompleted = Math.round(
            (progressEvent.loaded * 100) / progressEvent.total
          );
          loader.innerHTML= "Upload process: " + percentCompleted + "%";
          console.log(`upload process: ${percentCompleted}%`);
        }
      })
        .then(res => {
          console.log(res.data);
          message.innerHTML = res.data.message
         urlLink.innerHTML += "<a href='"+res.data.urls+"'>Download File</a>";
          // console.log(res.data.url);
        
        })
      }) 
   

     
  

  </script>



<script>
  feather.replace()
</script>
</body>

</html>